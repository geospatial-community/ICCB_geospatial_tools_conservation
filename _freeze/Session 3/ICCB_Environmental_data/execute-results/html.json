{
  "hash": "7ca11c40224dd7520ee28785e3df51c7",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"ICCB Environmental data download\"\nauthor: \"Scott Forrest and Charlotte Patterson\"\ndate: \"2025-06-14\"\nexecute: \n  cache: false\n# bibliography: references.bib\ntoc: true\nnumber-sections: false\nformat: \n  html:\n    self-contained: true\n    code-fold: show\n    code-tools: true\n    df-print: paged\n    code-line-numbers: true\n    code-overflow: scroll\n    fig-format: png\n    fig-dpi: 300\n  pdf:\n    geometry: \n      - top=30mm\n      - left=30mm\neditor:\n  source\nabstract: |\n  In this script we are downloading current and future environmental data (as rasters) to use in species distribution models (SDMs) for koalas (Phascolarctos cinereus) in the South-East Queensland (SEQ) region. \n---\n\n\n\n\n## Import packages\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(terra)\nlibrary(dplyr)\nlibrary(sf)\nlibrary(ggplot2)\n```\n:::\n\n\n\n\n## Load South East Queensland (SEQ) boundary\n\nWe start by defining our study area, which is the South East Queensland (SEQ) region. We will use the Local Government Areas (LGA) shapefile to define the extent of SEQ.\n\nhttps://qldspatial.information.qld.gov.au/catalogue/custom/detail.page?fid={3F3DBD69-647B-4833-B0A5-CC43D5E70699}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load the study area shapefile\nLGA <- st_read(\"Data/Environmental_variables/Local_Government_Areas.shp\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `Local_Government_Areas' from data source \n  `/Users/scottforrest/Library/CloudStorage/OneDrive-QueenslandUniversityofTechnology/PhD - Scott Forrest/GIT/ICCB_geospatial_tools_conservation/Session 3/Data/Environmental_variables/Local_Government_Areas.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 78 features and 8 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 137.9946 ymin: -29.17927 xmax: 153.5519 ymax: -9.087991\nGeodetic CRS:  GDA94\n```\n\n\n:::\n\n```{.r .cell-code}\n# Check the coordinate reference system (CRS)\nst_crs(LGA)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCoordinate Reference System:\n  User input: GDA94 \n  wkt:\nGEOGCRS[\"GDA94\",\n    DATUM[\"Geocentric Datum of Australia 1994\",\n        ELLIPSOID[\"GRS 1980\",6378137,298.257222101,\n            LENGTHUNIT[\"metre\",1]]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433]],\n    CS[ellipsoidal,2],\n        AXIS[\"geodetic latitude (Lat)\",north,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        AXIS[\"geodetic longitude (Lon)\",east,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n    USAGE[\n        SCOPE[\"Horizontal component of 3D system.\"],\n        AREA[\"Australia including Lord Howe Island, Macquarie Island, Ashmore and Cartier Islands, Christmas Island, Cocos (Keeling) Islands, Norfolk Island. All onshore and offshore.\"],\n        BBOX[-60.55,93.41,-8.47,173.34]],\n    ID[\"EPSG\",4283]]\n```\n\n\n:::\n\n```{.r .cell-code}\n# Convert to WGS84\nLGA <- LGA %>% st_transform(7856)\n\n# Select local govt. areas for South East Queensland\nLGA_SEQ <- LGA %>% \n  filter(lga %in% c(\"Brisbane City\", \n                    \"Moreton Bay City\", \n                    \"Logan City\", \n                    \"Ipswich City\", \n                    \"Redland City\", \n                    \"Scenic Rim Regional\", \n                    \"Somerset Regional\", \n                    \"Lockyer Valley Regional\", \n                    \"Gold Coast City\", \n                    \"Sunshine Coast Regional\", \n                    \"Toowoomba Regional\", \n                    \"Noosa Shire\"))\n\nggplot() +\n  geom_sf(data = LGA, color = \"black\") +\n  geom_sf(data = LGA_SEQ, fill = \"purple3\", alpha = 0.5, color = \"black\", size = 0.2) +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  labs(title = \"Local Government Areas Queensland (SEQ in purple)\")\n```\n\n::: {.cell-output-display}\n![](ICCB_Environmental_data_files/figure-html/unnamed-chunk-2-1.png)\n:::\n\n```{.r .cell-code}\nggplot() +\n  geom_sf(data = LGA_SEQ, fill = \"purple3\", alpha = 0.5, color = \"black\", size = 0.2) +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  labs(title = \"Local Government Areas South East Queensland (SEQ)\")\n```\n\n::: {.cell-output-display}\n![](ICCB_Environmental_data_files/figure-html/unnamed-chunk-2-2.png)\n:::\n:::\n\n\n\n\n## Merge into a single polygon\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Merge the SEQ LGAs into one polygon\nSEQ_extent <- st_union(LGA_SEQ)\n\nggplot() +\n  geom_sf(data = SEQ_extent, fill = \"purple3\", alpha = 0.5, color = \"black\", size = 0.2) +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  ggtitle(\"South-East Queensland Spatial Extent\") + \n  theme_bw() \n```\n\n::: {.cell-output-display}\n![](ICCB_Environmental_data_files/figure-html/unnamed-chunk-3-1.png)\n:::\n:::\n\n\n\n\n## Save SEQ extent for other scripts\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Convert our SEQ extent to a SpatExtent object by converting to a SpatVector\nSEQ_extent.vect <- terra::vect(SEQ_extent)\n\n# Write the SEQ extent to a shapefile\nwriteVector(SEQ_extent.vect, \"Data/Environmental_variables/SEQ_extent.shp\", overwrite = T)\n```\n:::\n\n\n\n\n## Load current environmental data\n\nLayers were made available to us by the EcoCommons team and were created by Toombs and Ma (2025):\n\nToombs, N., and Ma S., 2025, A High-Resolution Dataset of 19 Bioclimatic Indices over Australia, Climate Projections and Services â€“ Queensland Treasury, Brisbane, Queensland. [https://longpaddock.qld.gov.au/qld-future-climate/data-info/tern/]\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfiles <- list.files(\"Data/Environmental_variables/Current_climate_QLD\", \n             pattern = \".tif$\", \n             full.names = TRUE)\n\n# Load all bioclim rasters\ncurrent_bioclim <- lapply(files, terra::rast) \n\n# Make into one raster stack\ncurrent_bioclim <- rast(current_bioclim)\n\n# Plot the current bioclimatic variables\nplot(current_bioclim)\n```\n\n::: {.cell-output-display}\n![](ICCB_Environmental_data_files/figure-html/unnamed-chunk-5-1.png)\n:::\n\n```{.r .cell-code}\n# Examine the resolution\ncurrent_bioclim\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nclass       : SpatRaster \ndimensions  : 681, 841, 19  (nrow, ncol, nlyr)\nresolution  : 0.05, 0.05  (x, y)\nextent      : 111.975, 154.025, -44.025, -9.975  (xmin, xmax, ymin, ymax)\ncoord. ref. : lon/lat WGS 84 (EPSG:4326) \nsources     : bioclim_01.tif  \n              bioclim_02.tif  \n              bioclim_03.tif  \n              ... and 16 more sources\nnames       : bioclim_01, bioclim_02, bioclim_03, bioclim_04, bioclim_05, bioclim_06, ... \n```\n\n\n:::\n\n```{.r .cell-code}\n# Check the CRS\ncrs(current_bioclim)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"GEOGCRS[\\\"WGS 84\\\",\\n    ENSEMBLE[\\\"World Geodetic System 1984 ensemble\\\",\\n        MEMBER[\\\"World Geodetic System 1984 (Transit)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G730)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G873)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G1150)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G1674)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G1762)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G2139)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G2296)\\\"],\\n        ELLIPSOID[\\\"WGS 84\\\",6378137,298.257223563,\\n            LENGTHUNIT[\\\"metre\\\",1]],\\n        ENSEMBLEACCURACY[2.0]],\\n    PRIMEM[\\\"Greenwich\\\",0,\\n        ANGLEUNIT[\\\"degree\\\",0.0174532925199433]],\\n    CS[ellipsoidal,2],\\n        AXIS[\\\"geodetic latitude (Lat)\\\",north,\\n            ORDER[1],\\n            ANGLEUNIT[\\\"degree\\\",0.0174532925199433]],\\n        AXIS[\\\"geodetic longitude (Lon)\\\",east,\\n            ORDER[2],\\n            ANGLEUNIT[\\\"degree\\\",0.0174532925199433]],\\n    USAGE[\\n        SCOPE[\\\"Horizontal component of 3D system.\\\"],\\n        AREA[\\\"World.\\\"],\\n        BBOX[-90,-180,90,180]],\\n    ID[\\\"EPSG\\\",4326]]\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# Update CRS to EPSG:7856 (GDA2020 / MGA zone 56)\ncurrent_bioclim <- terra::project(current_bioclim, \"EPSG:7856\")\n\n# Our resolution is now ~5km by 5km\ncurrent_bioclim\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nclass       : SpatRaster \ndimensions  : 834, 898, 19  (nrow, ncol, nlyr)\nresolution  : 5590.925, 5590.925  (x, y)\nextent      : -4407995, 612655.7, 4234346, 8897178  (xmin, xmax, ymin, ymax)\ncoord. ref. : GDA2020 / MGA zone 56 (EPSG:7856) \nsource(s)   : memory\nnames       : bioclim_01, bioclim_02, bioclim_03, bioclim_04, bioclim_05, bioclim_06, ... \nmin values  :   5.182303,   5.520304,   35.25507,   105.7126,   16.82971,  -4.954343, ... \nmax values  :  29.453394,  16.870607,   61.84691,   680.0889,   42.45033,  22.998774, ... \n```\n\n\n:::\n:::\n\n\n\n\n## Mask and crop to SEQ extent\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Mask the current bioclimatic variables to the SEQ extent\ncurrent_bioclim <- terra::mask(current_bioclim, SEQ_extent.vect)\n\n# Crop to the SEQ region\ncurrent_bioclim <- terra::crop(current_bioclim, SEQ_extent.vect)\n\n# Plot all current bioclimatic variables\nplot(current_bioclim)\n```\n\n::: {.cell-output-display}\n![](ICCB_Environmental_data_files/figure-html/unnamed-chunk-6-1.png)\n:::\n\n```{.r .cell-code}\n# Save the current environmental covariates\nwriteRaster(current_bioclim,\n            filename = \"Data/Environmental_variables/SEQ_current_bioclim.tif\",\n            overwrite = T)\n```\n:::\n\n\n\n\n## Load future environmental data\n\nHere we load outputs from a moderate-high emissions shared socio-economic path scenario (SSP 3.70) for the year 2090 (2080 - 2099).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfiles <- list.files(\"Data/Environmental_variables/Future_climate_SSP370_2090\", \n             pattern = \".tif$\", \n             full.names = TRUE)\n\n# Load all bioclim rasters\nfuture_bioclim <- lapply(files, terra::rast) \n\n# Make into one raster stack\nfuture_bioclim <- rast(future_bioclim)\n\n# Plot the future bioclimatic variables\nplot(future_bioclim)\n```\n\n::: {.cell-output-display}\n![](ICCB_Environmental_data_files/figure-html/unnamed-chunk-7-1.png)\n:::\n\n```{.r .cell-code}\n# Examine the resolution\nfuture_bioclim\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nclass       : SpatRaster \ndimensions  : 681, 841, 19  (nrow, ncol, nlyr)\nresolution  : 0.05, 0.05  (x, y)\nextent      : 111.975, 154.025, -44.025, -9.975  (xmin, xmax, ymin, ymax)\ncoord. ref. : lon/lat WGS 84 (EPSG:4326) \nsources     : bioclim_01.tif  \n              bioclim_02.tif  \n              bioclim_03.tif  \n              ... and 16 more sources\nnames       : bioclim_01, bioclim_02, bioclim_03, bioclim_04, bioclim_05, bioclim_06, ... \n```\n\n\n:::\n\n```{.r .cell-code}\n# Check the CRS\ncrs(future_bioclim)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"GEOGCRS[\\\"WGS 84\\\",\\n    ENSEMBLE[\\\"World Geodetic System 1984 ensemble\\\",\\n        MEMBER[\\\"World Geodetic System 1984 (Transit)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G730)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G873)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G1150)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G1674)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G1762)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G2139)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G2296)\\\"],\\n        ELLIPSOID[\\\"WGS 84\\\",6378137,298.257223563,\\n            LENGTHUNIT[\\\"metre\\\",1]],\\n        ENSEMBLEACCURACY[2.0]],\\n    PRIMEM[\\\"Greenwich\\\",0,\\n        ANGLEUNIT[\\\"degree\\\",0.0174532925199433]],\\n    CS[ellipsoidal,2],\\n        AXIS[\\\"geodetic latitude (Lat)\\\",north,\\n            ORDER[1],\\n            ANGLEUNIT[\\\"degree\\\",0.0174532925199433]],\\n        AXIS[\\\"geodetic longitude (Lon)\\\",east,\\n            ORDER[2],\\n            ANGLEUNIT[\\\"degree\\\",0.0174532925199433]],\\n    USAGE[\\n        SCOPE[\\\"Horizontal component of 3D system.\\\"],\\n        AREA[\\\"World.\\\"],\\n        BBOX[-90,-180,90,180]],\\n    ID[\\\"EPSG\\\",4326]]\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# Update CRS \nfuture_bioclim <- terra::project(future_bioclim, \"EPSG:7856\")\n\n# Our resolution is now ~5km by 5km\nfuture_bioclim\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nclass       : SpatRaster \ndimensions  : 834, 898, 19  (nrow, ncol, nlyr)\nresolution  : 5590.925, 5590.925  (x, y)\nextent      : -4407995, 612655.7, 4234346, 8897178  (xmin, xmax, ymin, ymax)\ncoord. ref. : GDA2020 / MGA zone 56 (EPSG:7856) \nsource(s)   : memory\nnames       : bioclim_01, bioclim_02, bioclim_03, bioclim_04, bioclim_05, bioclim_06, ... \nmin values  :    0.00000,    0.00000,     0.0000,     0.0000,    0.00000,  -2.243844, ... \nmax values  :   33.02249,   16.09955,    66.1461,   706.1523,   46.24717,  25.827158, ... \n```\n\n\n:::\n:::\n\n\n\n\n## Mask to SEQ extent\n\nWe can see that for these layers the water surrounding Australia is not NA, but are values of 0. In some cells this introduces an artifact on the coastline where the values in some cells are an average between realistic values and 0, which results in cells with unusual and unrealistic values. We will do our best to mask these out.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# First mask and crop by the SEQ extent\nfuture_bioclim <- terra::mask(future_bioclim, SEQ_extent.vect) \nfuture_bioclim <- terra::crop(future_bioclim, SEQ_extent.vect)\n\n# Plot one of the variables - max temp of the warmest month\nplot(future_bioclim[[5]], main = \"Future BIO5\")\n```\n\n::: {.cell-output-display}\n![](ICCB_Environmental_data_files/figure-html/unnamed-chunk-8-1.png)\n:::\n:::\n\n\n\n\nWe can clearly see the artifacts in BIO5, which are not present in the current layers.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(current_bioclim[[5]], main = \"Current BIO5\")\n```\n\n::: {.cell-output-display}\n![](ICCB_Environmental_data_files/figure-html/unnamed-chunk-9-1.png)\n:::\n:::\n\n\n\n\nIf we plot a histogram of the values we can see where we can set a threshold to exclude those lower values on the coastline. We tested values to ensure that we were removing as many of the dodgy values at the coast whilst retaining all real values, and the best balance was 28 degrees.\n\nUnfortunately now we have slightly fewer cells on the coastline, but as these were artifacts we don't have the true data for those cells anyway.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# plot the distribution of values in BIO5\nhist(future_bioclim[[5]], breaks = 100)\n```\n\n::: {.cell-output-display}\n![](ICCB_Environmental_data_files/figure-html/unnamed-chunk-10-1.png)\n:::\n\n```{.r .cell-code}\n# create a mask for the artifacts, which we will apply across all of the layers\nartifact_mask <- future_bioclim[[5]] > 28\nnames(artifact_mask) <- \"artifact_mask\"\n\n# plot the artifact mask\nplot(artifact_mask)\n```\n\n::: {.cell-output-display}\n![](ICCB_Environmental_data_files/figure-html/unnamed-chunk-10-2.png)\n:::\n\n```{.r .cell-code}\n# plot the updated future BIO5 layer\nplot(future_bioclim[[5]], main = \"Future BIO5 - unmasked\")\n```\n\n::: {.cell-output-display}\n![](ICCB_Environmental_data_files/figure-html/unnamed-chunk-10-3.png)\n:::\n\n```{.r .cell-code}\n# set all artifact values to NA (across all layers)\nfuture_bioclim <- terra::mask(future_bioclim, artifact_mask, maskvalues = 0) # Set all values of 0 to NA\n\n# plot the updated future BIO5 layer\nplot(future_bioclim[[5]], main = \"Future BIO5 - masked\")\n```\n\n::: {.cell-output-display}\n![](ICCB_Environmental_data_files/figure-html/unnamed-chunk-10-4.png)\n:::\n\n```{.r .cell-code}\nplot(current_bioclim[[5]], main = \"Current BIO5\")\n```\n\n::: {.cell-output-display}\n![](ICCB_Environmental_data_files/figure-html/unnamed-chunk-10-5.png)\n:::\n\n```{.r .cell-code}\n# this removes those lower values\nhist(future_bioclim[[5]], breaks = 100)\n```\n\n::: {.cell-output-display}\n![](ICCB_Environmental_data_files/figure-html/unnamed-chunk-10-6.png)\n:::\n:::\n\n\n\n\nWe can see there are a couple raster cells that have artifacts, but we can filter by the difference between the current and future layers to remove these. Unfortunately, temperature is only going to increase, so we can filter by values where the difference is negative for the BIOCLIM 5 layer, which is the max temperature of the warmest month.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# have a look at the difference between current and future\nplot(future_bioclim[[5]] - current_bioclim[[5]])\n```\n\n::: {.cell-output-display}\n![](ICCB_Environmental_data_files/figure-html/unnamed-chunk-11-1.png)\n:::\n\n```{.r .cell-code}\nmin(values(future_bioclim[[5]] - current_bioclim[[5]]), na.rm = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -1.306969\n```\n\n\n:::\n\n```{.r .cell-code}\n# save that and create a mask for the artifact cells\ntemp_diff <- future_bioclim[[5]] - current_bioclim[[5]]\ntemp_diff_mask <- temp_diff > 1 # there is one remaining artifact cell that's about 0.7, so we'll remove that\n\n# have a look at the mask\nplot(temp_diff_mask)\n```\n\n::: {.cell-output-display}\n![](ICCB_Environmental_data_files/figure-html/unnamed-chunk-11-2.png)\n:::\n\n```{.r .cell-code}\n# these values look much better without the artifacts\nplot(mask(future_bioclim[[5]], temp_diff_mask, maskvalues = 0), main = \"Future BIO5 - masked by difference\")\n```\n\n::: {.cell-output-display}\n![](ICCB_Environmental_data_files/figure-html/unnamed-chunk-11-3.png)\n:::\n\n```{.r .cell-code}\n# we'll apply that mask to all layers\nfuture_bioclim <- mask(future_bioclim, temp_diff_mask, maskvalues = 0)\n```\n:::\n\n\n\n\nNow that we have applied the artifact mask across all layers, they look better.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(future_bioclim)\n```\n\n::: {.cell-output-display}\n![](ICCB_Environmental_data_files/figure-html/unnamed-chunk-12-1.png)\n:::\n:::\n\n\n\n\nNow we can save the future environmental covariates for SEQ.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Save the cropped and masked future environmental covariates\nwriteRaster(future_bioclim,\n            filename = \"Data/Environmental_variables/SEQ_future_bioclim.2090.SSP370.tif\",\n            overwrite = T)\n```\n:::\n\n\n\n\n## Load future environmental data 2\n\nHere we load outputs from a low emissions shared socio-economic path scenario (SSP 1.26) for the year 2090 (2080 - 2099).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfiles <- list.files(\"Data/Environmental_variables/Future_climate_SSP126_2090\", \n             pattern = \".tif$\", \n             full.names = TRUE)\n\n# Load all bioclim rasters\nfuture_bioclim <- lapply(files, terra::rast) \n\n# Make into one raster stack\nfuture_bioclim <- rast(future_bioclim)\n\nplot(future_bioclim)\n```\n\n::: {.cell-output-display}\n![](ICCB_Environmental_data_files/figure-html/unnamed-chunk-14-1.png)\n:::\n\n```{.r .cell-code}\n# Examine the resolution\nfuture_bioclim\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nclass       : SpatRaster \ndimensions  : 681, 841, 19  (nrow, ncol, nlyr)\nresolution  : 0.05, 0.05  (x, y)\nextent      : 111.975, 154.025, -44.025, -9.975  (xmin, xmax, ymin, ymax)\ncoord. ref. : lon/lat WGS 84 (EPSG:4326) \nsources     : bioclim_01.tif  \n              bioclim_02.tif  \n              bioclim_03.tif  \n              ... and 16 more sources\nnames       : bioclim_01, bioclim_02, bioclim_03, bioclim_04, bioclim_05, bioclim_06, ... \nmin values  :    0.00000,    0.00000,     0.0000,         ? ,         ? ,         ? , ... \nmax values  :   30.47033,   16.75114,    63.2751,         ? ,         ? ,         ? , ... \n```\n\n\n:::\n\n```{.r .cell-code}\n# Check the CRS\ncrs(future_bioclim)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"GEOGCRS[\\\"WGS 84\\\",\\n    ENSEMBLE[\\\"World Geodetic System 1984 ensemble\\\",\\n        MEMBER[\\\"World Geodetic System 1984 (Transit)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G730)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G873)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G1150)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G1674)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G1762)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G2139)\\\"],\\n        MEMBER[\\\"World Geodetic System 1984 (G2296)\\\"],\\n        ELLIPSOID[\\\"WGS 84\\\",6378137,298.257223563,\\n            LENGTHUNIT[\\\"metre\\\",1]],\\n        ENSEMBLEACCURACY[2.0]],\\n    PRIMEM[\\\"Greenwich\\\",0,\\n        ANGLEUNIT[\\\"degree\\\",0.0174532925199433]],\\n    CS[ellipsoidal,2],\\n        AXIS[\\\"geodetic latitude (Lat)\\\",north,\\n            ORDER[1],\\n            ANGLEUNIT[\\\"degree\\\",0.0174532925199433]],\\n        AXIS[\\\"geodetic longitude (Lon)\\\",east,\\n            ORDER[2],\\n            ANGLEUNIT[\\\"degree\\\",0.0174532925199433]],\\n    USAGE[\\n        SCOPE[\\\"Horizontal component of 3D system.\\\"],\\n        AREA[\\\"World.\\\"],\\n        BBOX[-90,-180,90,180]],\\n    ID[\\\"EPSG\\\",4326]]\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# Update CRS \nfuture_bioclim <- terra::project(future_bioclim, \"EPSG:7856\")\n\n# Our resolution is now ~5km by 5km\nfuture_bioclim\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nclass       : SpatRaster \ndimensions  : 834, 898, 19  (nrow, ncol, nlyr)\nresolution  : 5590.925, 5590.925  (x, y)\nextent      : -4407995, 612655.7, 4234346, 8897178  (xmin, xmax, ymin, ymax)\ncoord. ref. : GDA2020 / MGA zone 56 (EPSG:7856) \nsource(s)   : memory\nnames       : bioclim_01, bioclim_02, bioclim_03, bioclim_04, bioclim_05, bioclim_06, ... \nmin values  :    0.00000,    0.00000,    0.00000,     0.0000,    0.00000,  -4.081378, ... \nmax values  :   30.78085,   16.89395,   63.34254,   687.5474,   43.83962,  23.968334, ... \n```\n\n\n:::\n:::\n\n\n\n\n## Mask to SEQ extent\n\nWe will crop and mask the future bioclimatic variables to the SEQ extent, and apply the artifact mask as we did for the SSP 3.70 layers.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# First mask and crop by the SEQ extent\nfuture_bioclim <- terra::mask(future_bioclim, SEQ_extent.vect) \nfuture_bioclim <- terra::crop(future_bioclim, SEQ_extent.vect)\n\n# set all artifact values to NA\nfuture_bioclim <- terra::mask(future_bioclim, artifact_mask, maskvalues = 0) # Set all values of 0 to NA\nfuture_bioclim <- terra::mask(future_bioclim, temp_diff_mask, maskvalues = 0) # also use the temp difference mask\nplot(future_bioclim[[5]])\n```\n\n::: {.cell-output-display}\n![](ICCB_Environmental_data_files/figure-html/unnamed-chunk-15-1.png)\n:::\n\n```{.r .cell-code}\nplot(future_bioclim)\n```\n\n::: {.cell-output-display}\n![](ICCB_Environmental_data_files/figure-html/unnamed-chunk-15-2.png)\n:::\n\n```{.r .cell-code}\n# Save the future environmental covariates\nwriteRaster(future_bioclim,\n            filename = \"Data/Environmental_variables/SEQ_future_bioclim.2090.SSP126.tif\",\n            overwrite = T)\n```\n:::\n",
    "supporting": [
      "ICCB_Environmental_data_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}